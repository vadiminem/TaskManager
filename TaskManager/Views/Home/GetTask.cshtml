@model TaskManager.Models.DbTask;
@using TaskManager.Models;
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

@{
    if (ViewData["Layout"] == "false")
    {
        Layout = null;
    }
    ViewData["Title"] = Model.Name;

    switch (Model.Status)
    {
        case Status.Assigned:
            ViewData["Status"] = Localizer["TaskStatusAssigned"];
            ViewData["ChangeStatusAction"] = Localizer["ChangeStatusStart"];
            break;
        case Status.InProgress:
            ViewData["Status"] = Localizer["TaskStatusInProgress"];
            ViewData["ChangeStatusAction"] = Localizer["ChangeStatusPause"];
            break;
        case Status.Paused:
            ViewData["Status"] = Localizer["TaskStatusPaused"];
            ViewData["ChangeStatusAction"] = Localizer["ChangeStatusStart"];
            break;
        case Status.Completed:
            ViewData["Status"] = Localizer["TaskStatusCompleted"];
            break;

    }
}


<div class="control-panel">
    @if (Model.Status != Status.Completed)
    {
        <a asp-controller="Home" asp-action="Create" asp-route-id="@Model.Id">@Localizer["AddSubtask"]</a>
        <a class="change-status-action" data-id="@Model.Id" data-status="@Model.Status">@ViewData["ChangeStatusAction"]</a>
        <a class="change-status-action" data-id="@Model.Id" data-status="@Status.Completed">@Localizer["EndTask"]</a>
        <a asp-controller="Home" asp-action="Edit" asp-route-id="@Model.Id">@Localizer["EditTask"]</a>
    }
    <a asp-controller="Home" asp-action="Remove" asp-route-id="@Model.Id">@Localizer["RemoveTask"]</a>
</div>
<div class="task-content">
    <h1 class="task-name">@Model.Name</h1>
    <h3></h3>
    <p class="task-description">@Model.Description</p>
    <p class="task-status"> Статус: <b>@ViewData["Status"]</b></p>
    <p class="task-labour-input">
        @{
            var leadTime = TimeSpan.FromTicks(Model.LeadTime);
        }

        @(new TimeSpan(leadTime.Days, leadTime.Hours, leadTime.Minutes, leadTime.Seconds)) / @TimeSpan.FromTicks(@Model.LabourInput)
    </p>
    <p class="task-performers">Исполнители: @Model.Performers</p>
    <p class="task-dates">Время выполнения: с @Model.RegistrationDate до @Model.EndDate</p>

</div>

@section Tasks {
    <div class="tasks-list">
        <ul class="task-names"></ul>
    </div>
    <div class="new-task-action">
        <a asp-controller="Home" asp-action="Create">@Localizer["NewTaskAction"]</a>
    </div>
}

@section Scripts {
    <script src="~/js/site.js" asp-append-version="true"></script>
}